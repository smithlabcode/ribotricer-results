library(dirss)
utr5 <- read.table("utr5_cnt_tbl.tsv", head=T, row.names=1)
head(utr5)
cds <- read.table("cds_cnt_tbl.tsv", head=T, row.names=1)
utr3 <- read.table("utr3_cnt_tbl.tsv", head=T, row.names=1)
res <- dirss(utr5, cds, utr3, c("c", "c", "t", "t"))
gene.utr5 = rownames(utr5)
gene.cds = rownames(cds)
gene.utr3 = rownames(utr3)
gene = intersect(gene.utr5, gene.cds)
length(gene)
gene = intersect(gene, gene.utr3)
length(gene)
utr5 = utr5[gene,]
head(utr5)
cds = cds[gene,]
utr3 = utr3[gene,]
res <- dirss(utr5, cds, utr3, c("c", "c", "t", "t"))
dirss(utr5, cds, utr3, c("c", "c", "t", "t"))
df1 = data.frame(a=c(1,2,3,4),b=c(5,6,7,8))
df1
rownames(df1) = c('a','b','c','d')
df1
df2 = data.frame(a=c(100,200,300,400,500),b=c(9,99,999,9999,99999))
rownames(df2) = c('a','b','d','e','f')
df2
df1+df2
getwd()
setwd("/home/cmb-panasas2/wenzhenl/github/dirss/")
library(devtools)
devtools::install('.')
res <- dirss(utr5, cds, utr3, c("c", "c", "t", "t"))
haha = rbind(utr5, cds)
devtools::install('.')
devtools::install('.')
quit()
library(devtools)
devtools::install('.')
library(dirss)
quit()
remove.packages('dirss')
quit()
library(devtools)
devtools::install('.')
library(dirss)
head(uorf)
setwd('/home/cmb-panasas2/wenzhenl/github/ribocop-results/real/')
uorf = read.table('uorf_cnt.txt', head=T, row.names=1)
cds = read.table('cds_cnt.txt', head=T, row.names=1)
res = dirss(uorf, cds, c('c', 'c', 't', 't'))
head(res)
summary(res)
getwd()
write.table(res, 'diff_U_full.txt', quote=F)
sig = res[res$padj < 0.05, ]
res$padj < 0.05
sig = res[res$padj < 0.05,]
sig = res[!is.na(res$padj) & res$padj < 0.05, ]
dim(sig)
write.table(sig, 'diff_U_sig.txt', quote=F)
quit()
data = read.table('foldchange.txt', head=T, row.names=1)
head(data)
pdf('cor_uorf_te.pdf')
plot(data$FC_U, data$FC_T)
dev.off()
pdf('cor_uorf_te.pdf')
plot(log10(data$FC_U), log10(data$FC_T))
escapee = data[data$FC_U < 0 & data$FC_T
,]
dim(escapee)
dim(data[data$FC_T >0,])
write.table(escapee, 'escapee.txt', quote=F)
quit()
ls()
library(riborex)
ls()
head(cds)
rna = read.table('rna_cnt.txt', head=T, row.names=1)
ribo = read.table('ribo_cnt.txt', head=T, row.names=1)
res = riborex(rna, ribo, c('c', 'c', 't', 't'))
res = riborex(rna, ribo, c('c', 'c', 't', 't'), c('c', 'c', 't', 't')
)
summary(res)
write.table('diff_T_full.txt', res, quote=F)
write.table(res, 'diff_T_full.txt', quote=F)
sig = res[res$padj < 0.05, ]
dim(sig)
write.table(sig, 'diff_T_sig.txt', quote=F)
quit()
ls()
head(res)
dim(res[res$log2FoldChange < -10,])
head(rna)
rna = rna + 1
head(rna)
ribo = ribo + 1
res = riborex(rna, ribo, c('c', 'c', 't', 't'), c('c', 'c', 't', 't'))
library(riborex)
res = riborex(rna, ribo, c('c', 'c', 't', 't'), c('c', 'c', 't', 't'))
write.table(res, 'diff_T_full.txt', quote=F)
sig = res[res$padj < 0.05, ]
sig = res[!is.na(res$padj)&res$padj < 0.05, ]
dim(sig)
write.table(sig, 'diff_T_sig.txt', quote=F)
dim(sig[sig$log2FoldChange < -10,])
dim(sig[sig$log2FoldChange < -30,])
dim(sig[sig$log2FoldChange < -20,])
dim(sig[sig$log2FoldChange < -10,])
dim(sig[sig$log2FoldChange < -5,])
quit()
ls()
uorf = read.table('uorf_cnt.txt', head=T, row.names=1)
cds = read.table('cds_cnt.txt', head=T, row.names=1)
dim(uorf)
dim(cds)
uorf = uorf + 1
cds = cds + 1
library(dirss)
library(dirrs)
library(dirss)
quit()
library(dirss)
ls()
res = dirss(uorf, cds, c('c','c','t','t'))
head(res)
write.table(res, 'diff_U_full.txt', quote=F)
sig = res[!is.na(res$padj)&res$padj<0.05, ]
dim(sig)
write.table(sig, 'diff_U_sig.txt', quote=F)
dim(sig[sig$log2FoldChange > 10,])
dim(sig[sig$log2FoldChange > 30,])
dim(sig[sig$log2FoldChange > 20,])
head(uorf)
quit()
data = read.table('foldchange.txt', head=T, row.names=1)
head(data)
plot(data$FC_U, data$FC_T, xlab='log2 fold change of uORF usage', ylab='log2 fold change of translation efficiency')
pdf('fold_change_cor.pdf')
plot(data$FC_U, data$FC_T, xlab='log2 fold change of uORF usage', ylab='log2 fold change of translation efficiency')
dev.off()
pdf('fold_change_cor.pdf')
plot(data$FC_U, data$FC_T, xlab='log2 fold change of uORF usage', ylab='log2 fold change of translation efficiency', pch='.')
dev.off()
escapee = data[data$FC_U <0 &data$FC_T>0,]
dim(escapee)
write.table(escapee, 'escapee.txt', quote=F)
quit()
data=read.table('foldchange.txt', head=T, row.names=1)
head(data)
pdf('fold_change_cor.pdf')
plot(data$FC_U, data$FC_T, xlab='log2 fold change of uORF usage', ylab='log2 fold change of translation efficiency')
dev.off()
write.table(data[data$FC_U<0&data$FC_T>0,], 'escapee.txt', quote=F)
head(cds)
dim(uorf[rowMeans(uorf)>=50,])
dim(uorf)
dim(uorf[rowMeans(uorf)>=10,])
dim(cds)
library(dirss)
cds = read.table('cds_cnt.txt', head=T, row.names=1)
head(cds)
keep = rownames(cds)[rowMeans(cds)>=50]
length(keep)
uorf=read.table('uorf_cnt.txt', head=T, row.names=1)
cds=cds[keep,]
uorf=uorf[keep,]
dim(cds)
dim(uorf)
uorf=uorf+1
res=dirss(uorf, cds, c('c','c','t','t'))
head(res)
write.table(res, 'diff_U_full.txt', quote=F)
sig = res[!is.na(res$padj) & res$padj < 0.05,]
dim(sig)
head(sig)
quit()
